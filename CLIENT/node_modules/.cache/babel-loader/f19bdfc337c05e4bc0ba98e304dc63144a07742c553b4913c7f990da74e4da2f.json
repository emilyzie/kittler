{"ast":null,"code":"var _jsxFileName = \"/Users/midhu1/Projects/mediaconsumption/CLIENT/src/pages/ProfilePage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useClerk, useUser } from '@clerk/clerk-react';\nimport { SupabaseContext } from '../utils/auth'; // Import the context directly\nimport WatchlistPage from './WatchlistPage';\nimport FriendsBar from '../components/common/FriendsBar';\nimport FriendRequestsDropdown from '../components/common/FriendRequests';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProfilePage = () => {\n  _s();\n  const navigate = useNavigate();\n  const {\n    user: clerkUser\n  } = useUser(); // Get Clerk user\n  const {\n    client: supabase,\n    isLoading: supabaseLoading\n  } = useContext(SupabaseContext); // Use context to get Supabase client and its loading state\n\n  const [profile, setProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [friends, setFriends] = useState([]);\n  useEffect(() => {\n    if (supabaseLoading) {\n      console.log(\"Supabase client is still loading\");\n      return; // Do nothing while the client is loading\n    }\n    if (!supabase) {\n      console.error(\"Supabase client is not available\");\n      navigate('/');\n      return;\n    }\n    const fetchProfileData = async () => {\n      if (!clerkUser) {\n        console.error(\"No Clerk user information available.\");\n        console.log(\"CLERKKK\", clerkUser.id);\n        navigate('/login');\n        return;\n      }\n      const {\n        data,\n        error\n      } = await supabase.from('profiles').select('*').eq('clerk_id', clerkUser.id).single();\n      if (error) {\n        console.error('Error fetching Supabase profile:', error.message);\n        navigate('/');\n        return;\n      }\n      setProfile(data);\n      setLoading(false);\n    };\n    fetchProfileData();\n  }, [clerkUser, navigate, supabase, supabaseLoading]);\n  useEffect(() => {\n    if (!profile) return;\n    const fetchFriends = async () => {\n      const {\n        data,\n        error\n      } = await supabase.from('friends').select('friend_id, friend_profile:friend_id (username)').eq('user_id', profile.user_id).eq('status', 'accepted');\n      if (error) {\n        console.error('Error fetching friends:', error.message);\n      } else {\n        setFriends(data);\n      }\n    };\n    fetchFriends();\n  }, [profile, supabase]);\n  if (loading || supabaseLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-screen h-screen flex flex-col items-center pt-10\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-end w-5/6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-bar grid grid-cols-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"py-1 cursor-pointer text-right border-b border-black\",\n          children: \"Profile\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"py-1 cursor-pointer text-right border-b border-black\",\n          children: \"Lists\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"py-1 cursor-pointer text-right border-b border-black\",\n          children: \"Friends\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-2xl mb-16 text-center\",\n      children: profile ? `Profile: ${profile.username}` : 'No Profile Data'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Email:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), \" \", clerkUser.emailAddresses.length > 0 ? clerkUser.emailAddresses[0].emailAddress : 'No email available', /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Account Created:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), \" \", new Date(clerkUser.createdAt).toLocaleString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: friends.length > 0 ? \"grid grid-cols-2\" : \"hidden\",\n      children: friends.map(friend => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border-b flex justify-between w-3/4\",\n        children: friend.friend_profile.username\n      }, friend.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n_s(ProfilePage, \"bGE938wxvNdgnG1EjHURxw026mc=\", false, function () {\n  return [useNavigate, useUser];\n});\n_c = ProfilePage;\nexport default ProfilePage;\n\n// =====\n\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useClerk, useUser } from '@clerk/clerk-react';\n// import { useSupabaseClient } from '../utils/auth'; // Make sure this path is correct\n// import WatchlistPage from './WatchlistPage';\n// import FriendsBar from '../components/common/FriendsBar';\n// import FriendRequestsDropdown from '../components/common/FriendRequests';\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const { user: clerkUser } = useUser(); // Get Clerk user\n//   const supabase = useSupabaseClient();\n//     useEffect(() => {\n//     console.log(\"Supabase client in ProfilePage:\", supabase);\n//     if (!supabase) {\n//         console.error(\"Supabase client is null in ProfilePage\");\n//         navigate('/');  // Optionally redirect if the client isn't available\n//         return;\n//     }\n//     // Fetch profile data logic...\n//     }, [supabase, navigate]);\n\n//   const [profile, setProfile] = useState(null);\n//   const [loading, setLoading] = useState(true);\n//   const [friends, setFriends] = useState([]);\n\n//   useEffect(() => {\n//     const fetchProfileData = async () => {\n//       if (!clerkUser) {\n//         console.error(\"No Clerk user information available.\");\n//         navigate('/login');\n//         return;\n//       }\n\n//       const { data, error } = await supabase\n//         .from('profiles')\n//         .select('*')\n//         .eq('clerk_id', clerkUser.id)  // Assuming 'clerk_id' is stored in the profiles table\n//         .single();\n\n//       if (error) {\n//         console.error('Error fetching Supabase profile:', error.message);\n//         navigate('/');\n//         return;\n//       }\n\n//       setProfile(data);\n//       setLoading(false);\n//     };\n\n//     fetchProfileData();\n//   }, [clerkUser, navigate, supabase]);\n\n//   useEffect(() => {\n//     const fetchFriends = async () => {\n//       if (!profile) return;\n//       const { data, error } = await supabase\n//         .from('friends')\n//         .select('friend_id, friend_profile:friend_id (username)')\n//         .eq('user_id', profile.user_id)\n//         .eq('status', 'accepted');\n\n//       if (error) {\n//         console.error('Error fetching friends:', error.message);\n//       } else {\n//         setFriends(data);\n//       }\n//     };\n\n//     if (profile) fetchFriends();\n//   }, [profile, supabase]);\n\n//   if (loading) {\n//     return <div>Loading...</div>;\n//   }\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <div className=\"flex justify-end w-5/6\">\n//         <div className=\"tab-bar grid grid-cols-3\">\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\">Profile</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\">Lists</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\">Friends</span>\n//         </div>\n//       </div>\n//       <h1 className=\"text-2xl mb-16 text-center\">{profile ? `Profile: ${profile.username}` : 'No Profile Data'}</h1>\n//       <div>\n//         <strong>Email:</strong> {clerkUser.emailAddresses.length > 0 ? clerkUser.emailAddresses[0].emailAddress : 'No email available'}\n//         <br/>\n//         <strong>Account Created:</strong> {new Date(clerkUser.createdAt).toLocaleString()}\n//       </div>\n//       <div className={friends.length > 0 ? \"grid grid-cols-2\" : \"hidden\"}>\n//         {friends.map(friend => (\n//           <div key={friend.id} className=\"border-b flex justify-between w-3/4\">\n//             {friend.friend_profile.username}\n//             {/* Add delete button or other interaction */}\n//           </div>\n//         ))}\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\n\n// ====\n\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useClerk } from '@clerk/clerk-react';\n// import { useSupabaseClient } from '../utils/auth'; // Import the hook\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const { user } = useClerk();  // Directly access the user object from the Clerk hook\n//   const [loading, setLoading] = useState(true);\n//   const supabase = useSupabaseClient();\n\n//   useEffect(() => {\n//     if (!user) {\n//       console.error(\"No user information available\");\n//       navigate('/'); // Redirect or handle as necessary if user data isn't available\n//     } else {\n//       setLoading(false);\n//     }\n//   }, [user, navigate]);\n\n//   if (loading) {\n//     return <div>Loading user information...</div>;\n//   }\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <h1 className=\"text-2xl mb-16 text-center\">Profile: {user.username} {user.lastName}</h1>\n//       <div>\n//         <strong>Email:</strong> {user.emailAddresses.length > 0 ? user.emailAddresses[0].emailAddress : 'No email available'}\n//         <br/>\n//         <strong>Account Created:</strong> {new Date(user.createdAt).toLocaleString()}\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\n\n// // ProfilePage.js\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useSupabaseClient } from '../utils/auth'; // Import the hook\n// import WatchlistPage from './WatchlistPage';\n// import FriendsBar from '../components/common/FriendsBar';\n// import FriendRequestsDropdown from '../components/common/FriendRequests';\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const supabase = useSupabaseClient(); // Use the hook\n//   const [username, setUsername] = useState('Guest');\n//   const [loading, setLoading] = useState(true);\n//   const [userId, setUserId] = useState(null);\n//   const [toggle, setToggle] = useState(1);\n//   const [friends, setFriends] = useState([]);\n\n//   useEffect(() => {\n//     const fetchUserData = async () => {\n//       const { data: { user }, error: userError } = await supabase.auth.getUser();\n\n//       if (userError || !user) {\n//         console.log(\"Cooked.\");\n//         navigate('/');\n//         return;\n//       }\n\n//       setUserId(user.id);\n\n//       const { data: profile, error: profileError } = await supabase\n//         .from('profiles')\n//         .select('username')\n//         .eq('user_id', user.id)\n//         .single();\n\n//       if (profileError) {\n//         console.error('Error fetching user data:', profileError.message);\n//         navigate('/');\n//       } else if (profile) {\n//         setUsername(profile.username);\n//       }\n\n//       setLoading(false);\n//     };\n\n//     const fetchFriends = async () => {\n//       if (!userId) return; // Only fetch if userId is available\n//       const { data, error } = await supabase\n//         .from('friends')\n//         .select(`\n//           friend_id,\n//           friend_profile:friend_id (username) // Adjusted for correct relationship fetching\n//         `)\n//         .eq('user_id', userId)\n//         .eq('status', 'accepted');\n\n//       if (error) {\n//         console.error('Error fetching friends:', error.message);\n//       } else {\n//         console.log('Fetched friends data:', data); // Logs successful data fetch.\n\n//         setFriends(data.map(friend => ({\n//           id: friend.friend_id,\n//           username: friend.friend_profile.username  // Assuming the returned data structure from the query\n//         })));\n//       }\n//     };\n\n//     fetchUserData();\n\n//     if (userId) fetchFriends(); // Fetch friends if userId is available\n//   }, [navigate, supabase, userId]);\n\n//   if (loading) {\n//     return <div>Loading...</div>;\n//   }\n\n//   const updateToggle = (id) => {\n//     setToggle(id);\n//   };\n\n//   const deleteFriend = async (deletedId) => {\n//     if (window.confirm(`Are you sure you want to delete this friend?`)) {\n//       const { error } = await supabase\n//         .from('friends')\n//         .delete()\n//         .or(`and(user_id.eq.${userId},friend_id.eq.${deletedId}),and(user_id.eq.${deletedId},friend_id.eq.${userId})`);\n\n//       if (error) {\n//         console.error('Error deleting friend:', error.message);\n//       } else {\n//         setFriends(currentFriends => currentFriends.filter(friend => friend.id !== deletedId));\n//       }\n//     }\n//   };\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <div className=\"flex justify-end w-5/6\">\n//         <div className=\"tab-bar grid grid-col-1\">\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(1)}>Profile</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(2)}>Lists</span>\n//           <span className=\"pl-4 py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(3)}>Friends</span>\n//         </div>\n//       </div>\n//       <div className={toggle === 1 ? \"w-5/6\" : \"hidden\"}>\n//         <h1 className=\"text-2xl mb-16 text-left\">profpic {username}</h1>\n//         <div className=\"mt-16 grid grid-cols-4\">\n//           <div className=\"border-2 m-4 rounded-full py-8 px-4 grid grid-cols-1\">\n//             <span>lists: </span>\n//             <span>{friends.length}</span>\n//           </div>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">to consume: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consuming: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consumed: </span>\n//         </div>\n//       </div>\n//       <div className={toggle === 2 ? \"w-screen\" : \"hidden\"}>\n//         <WatchlistPage />\n//       </div>\n//       <div className={toggle === 3 ? \"grid grid-cols-2\" : \"hidden\"}>\n//         <div className=\"h-screen border-r-2 flex flex-col items-center\">\n//           <div className=\"m-6\">requests</div>\n//           <div className=\"m-6\"><FriendsBar userId={userId} /></div>\n//           <FriendRequestsDropdown userId={userId} />\n//         </div>\n//         <div className=\"flex flex-col items-center\">\n//           <h2 className=\"p-2 my-4\">friends</h2>\n//           {friends.map(friend => (\n//             <div className=\"border-b flex justify-between w-3/4\" key={friend.id}>\n//               {friend.username}\n//               <button className=\"hover:underline\" onClick={() => deleteFriend(friend.id)}>remove</button>\n//             </div>\n//           ))}\n//         </div>\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["React","useEffect","useState","useContext","useNavigate","useClerk","useUser","SupabaseContext","WatchlistPage","FriendsBar","FriendRequestsDropdown","jsxDEV","_jsxDEV","ProfilePage","_s","navigate","user","clerkUser","client","supabase","isLoading","supabaseLoading","profile","setProfile","loading","setLoading","friends","setFriends","console","log","error","fetchProfileData","id","data","from","select","eq","single","message","fetchFriends","user_id","children","fileName","_jsxFileName","lineNumber","columnNumber","className","username","emailAddresses","length","emailAddress","Date","createdAt","toLocaleString","map","friend","friend_profile","_c","$RefreshReg$"],"sources":["/Users/midhu1/Projects/mediaconsumption/CLIENT/src/pages/ProfilePage.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useClerk, useUser } from '@clerk/clerk-react';\nimport { SupabaseContext } from '../utils/auth'; // Import the context directly\nimport WatchlistPage from './WatchlistPage';\nimport FriendsBar from '../components/common/FriendsBar';\nimport FriendRequestsDropdown from '../components/common/FriendRequests';\n\nconst ProfilePage = () => {\n  const navigate = useNavigate();\n  const { user: clerkUser } = useUser(); // Get Clerk user\n  const { client: supabase, isLoading: supabaseLoading } = useContext(SupabaseContext); // Use context to get Supabase client and its loading state\n\n  const [profile, setProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [friends, setFriends] = useState([]);\n\n  useEffect(() => {\n    if (supabaseLoading) {\n      console.log(\"Supabase client is still loading\");\n      return; // Do nothing while the client is loading\n    }\n    if (!supabase) {\n      console.error(\"Supabase client is not available\");\n      navigate('/');\n      return;\n    }\n\n    const fetchProfileData = async () => {\n      if (!clerkUser) {\n        console.error(\"No Clerk user information available.\");\n        console.log(\"CLERKKK\", clerkUser.id)\n        navigate('/login');\n        return;\n      }\n\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('clerk_id', clerkUser.id)\n        .single();\n\n      if (error) {\n        console.error('Error fetching Supabase profile:', error.message);\n        navigate('/');\n        return;\n      }\n\n      setProfile(data);\n      setLoading(false);\n    };\n\n    fetchProfileData();\n  }, [clerkUser, navigate, supabase, supabaseLoading]);\n\n  useEffect(() => {\n    if (!profile) return;\n\n    const fetchFriends = async () => {\n      const { data, error } = await supabase\n        .from('friends')\n        .select('friend_id, friend_profile:friend_id (username)')\n        .eq('user_id', profile.user_id)\n        .eq('status', 'accepted');\n\n      if (error) {\n        console.error('Error fetching friends:', error.message);\n      } else {\n        setFriends(data);\n      }\n    };\n\n    fetchFriends();\n  }, [profile, supabase]);\n\n  if (loading || supabaseLoading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n      <div className=\"flex justify-end w-5/6\">\n        <div className=\"tab-bar grid grid-cols-3\">\n          <span className=\"py-1 cursor-pointer text-right border-b border-black\">Profile</span>\n          <span className=\"py-1 cursor-pointer text-right border-b border-black\">Lists</span>\n          <span className=\"py-1 cursor-pointer text-right border-b border-black\">Friends</span>\n        </div>\n      </div>\n      <h1 className=\"text-2xl mb-16 text-center\">{profile ? `Profile: ${profile.username}` : 'No Profile Data'}</h1>\n      <div>\n        <strong>Email:</strong> {clerkUser.emailAddresses.length > 0 ? clerkUser.emailAddresses[0].emailAddress : 'No email available'}\n        <br/>\n        <strong>Account Created:</strong> {new Date(clerkUser.createdAt).toLocaleString()}\n      </div>\n      <div className={friends.length > 0 ? \"grid grid-cols-2\" : \"hidden\"}>\n        {friends.map(friend => (\n          <div key={friend.id} className=\"border-b flex justify-between w-3/4\">\n            {friend.friend_profile.username}\n            {/* Add delete button or other interaction */}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default ProfilePage;\n\n\n// =====\n\n\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useClerk, useUser } from '@clerk/clerk-react';\n// import { useSupabaseClient } from '../utils/auth'; // Make sure this path is correct\n// import WatchlistPage from './WatchlistPage';\n// import FriendsBar from '../components/common/FriendsBar';\n// import FriendRequestsDropdown from '../components/common/FriendRequests';\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const { user: clerkUser } = useUser(); // Get Clerk user\n//   const supabase = useSupabaseClient();\n//     useEffect(() => {\n//     console.log(\"Supabase client in ProfilePage:\", supabase);\n//     if (!supabase) {\n//         console.error(\"Supabase client is null in ProfilePage\");\n//         navigate('/');  // Optionally redirect if the client isn't available\n//         return;\n//     }\n//     // Fetch profile data logic...\n//     }, [supabase, navigate]);\n\n//   const [profile, setProfile] = useState(null);\n//   const [loading, setLoading] = useState(true);\n//   const [friends, setFriends] = useState([]);\n\n//   useEffect(() => {\n//     const fetchProfileData = async () => {\n//       if (!clerkUser) {\n//         console.error(\"No Clerk user information available.\");\n//         navigate('/login');\n//         return;\n//       }\n\n//       const { data, error } = await supabase\n//         .from('profiles')\n//         .select('*')\n//         .eq('clerk_id', clerkUser.id)  // Assuming 'clerk_id' is stored in the profiles table\n//         .single();\n\n//       if (error) {\n//         console.error('Error fetching Supabase profile:', error.message);\n//         navigate('/');\n//         return;\n//       }\n\n//       setProfile(data);\n//       setLoading(false);\n//     };\n\n//     fetchProfileData();\n//   }, [clerkUser, navigate, supabase]);\n\n//   useEffect(() => {\n//     const fetchFriends = async () => {\n//       if (!profile) return;\n//       const { data, error } = await supabase\n//         .from('friends')\n//         .select('friend_id, friend_profile:friend_id (username)')\n//         .eq('user_id', profile.user_id)\n//         .eq('status', 'accepted');\n\n//       if (error) {\n//         console.error('Error fetching friends:', error.message);\n//       } else {\n//         setFriends(data);\n//       }\n//     };\n\n//     if (profile) fetchFriends();\n//   }, [profile, supabase]);\n\n//   if (loading) {\n//     return <div>Loading...</div>;\n//   }\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <div className=\"flex justify-end w-5/6\">\n//         <div className=\"tab-bar grid grid-cols-3\">\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\">Profile</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\">Lists</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\">Friends</span>\n//         </div>\n//       </div>\n//       <h1 className=\"text-2xl mb-16 text-center\">{profile ? `Profile: ${profile.username}` : 'No Profile Data'}</h1>\n//       <div>\n//         <strong>Email:</strong> {clerkUser.emailAddresses.length > 0 ? clerkUser.emailAddresses[0].emailAddress : 'No email available'}\n//         <br/>\n//         <strong>Account Created:</strong> {new Date(clerkUser.createdAt).toLocaleString()}\n//       </div>\n//       <div className={friends.length > 0 ? \"grid grid-cols-2\" : \"hidden\"}>\n//         {friends.map(friend => (\n//           <div key={friend.id} className=\"border-b flex justify-between w-3/4\">\n//             {friend.friend_profile.username}\n//             {/* Add delete button or other interaction */}\n//           </div>\n//         ))}\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\n\n\n// ====\n\n\n\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useClerk } from '@clerk/clerk-react';\n// import { useSupabaseClient } from '../utils/auth'; // Import the hook\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const { user } = useClerk();  // Directly access the user object from the Clerk hook\n//   const [loading, setLoading] = useState(true);\n//   const supabase = useSupabaseClient();\n\n//   useEffect(() => {\n//     if (!user) {\n//       console.error(\"No user information available\");\n//       navigate('/'); // Redirect or handle as necessary if user data isn't available\n//     } else {\n//       setLoading(false);\n//     }\n//   }, [user, navigate]);\n\n//   if (loading) {\n//     return <div>Loading user information...</div>;\n//   }\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <h1 className=\"text-2xl mb-16 text-center\">Profile: {user.username} {user.lastName}</h1>\n//       <div>\n//         <strong>Email:</strong> {user.emailAddresses.length > 0 ? user.emailAddresses[0].emailAddress : 'No email available'}\n//         <br/>\n//         <strong>Account Created:</strong> {new Date(user.createdAt).toLocaleString()}\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\n\n\n\n\n// // ProfilePage.js\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useSupabaseClient } from '../utils/auth'; // Import the hook\n// import WatchlistPage from './WatchlistPage';\n// import FriendsBar from '../components/common/FriendsBar';\n// import FriendRequestsDropdown from '../components/common/FriendRequests';\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const supabase = useSupabaseClient(); // Use the hook\n//   const [username, setUsername] = useState('Guest');\n//   const [loading, setLoading] = useState(true);\n//   const [userId, setUserId] = useState(null);\n//   const [toggle, setToggle] = useState(1);\n//   const [friends, setFriends] = useState([]);\n\n//   useEffect(() => {\n//     const fetchUserData = async () => {\n//       const { data: { user }, error: userError } = await supabase.auth.getUser();\n\n//       if (userError || !user) {\n//         console.log(\"Cooked.\");\n//         navigate('/');\n//         return;\n//       }\n\n//       setUserId(user.id);\n\n//       const { data: profile, error: profileError } = await supabase\n//         .from('profiles')\n//         .select('username')\n//         .eq('user_id', user.id)\n//         .single();\n\n//       if (profileError) {\n//         console.error('Error fetching user data:', profileError.message);\n//         navigate('/');\n//       } else if (profile) {\n//         setUsername(profile.username);\n//       }\n\n//       setLoading(false);\n//     };\n\n//     const fetchFriends = async () => {\n//       if (!userId) return; // Only fetch if userId is available\n//       const { data, error } = await supabase\n//         .from('friends')\n//         .select(`\n//           friend_id,\n//           friend_profile:friend_id (username) // Adjusted for correct relationship fetching\n//         `)\n//         .eq('user_id', userId)\n//         .eq('status', 'accepted');\n\n//       if (error) {\n//         console.error('Error fetching friends:', error.message);\n//       } else {\n//         console.log('Fetched friends data:', data); // Logs successful data fetch.\n\n//         setFriends(data.map(friend => ({\n//           id: friend.friend_id,\n//           username: friend.friend_profile.username  // Assuming the returned data structure from the query\n//         })));\n//       }\n//     };\n\n//     fetchUserData();\n\n//     if (userId) fetchFriends(); // Fetch friends if userId is available\n//   }, [navigate, supabase, userId]);\n\n//   if (loading) {\n//     return <div>Loading...</div>;\n//   }\n\n//   const updateToggle = (id) => {\n//     setToggle(id);\n//   };\n\n//   const deleteFriend = async (deletedId) => {\n//     if (window.confirm(`Are you sure you want to delete this friend?`)) {\n//       const { error } = await supabase\n//         .from('friends')\n//         .delete()\n//         .or(`and(user_id.eq.${userId},friend_id.eq.${deletedId}),and(user_id.eq.${deletedId},friend_id.eq.${userId})`);\n\n//       if (error) {\n//         console.error('Error deleting friend:', error.message);\n//       } else {\n//         setFriends(currentFriends => currentFriends.filter(friend => friend.id !== deletedId));\n//       }\n//     }\n//   };\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <div className=\"flex justify-end w-5/6\">\n//         <div className=\"tab-bar grid grid-col-1\">\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(1)}>Profile</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(2)}>Lists</span>\n//           <span className=\"pl-4 py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(3)}>Friends</span>\n//         </div>\n//       </div>\n//       <div className={toggle === 1 ? \"w-5/6\" : \"hidden\"}>\n//         <h1 className=\"text-2xl mb-16 text-left\">profpic {username}</h1>\n//         <div className=\"mt-16 grid grid-cols-4\">\n//           <div className=\"border-2 m-4 rounded-full py-8 px-4 grid grid-cols-1\">\n//             <span>lists: </span>\n//             <span>{friends.length}</span>\n//           </div>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">to consume: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consuming: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consumed: </span>\n//         </div>\n//       </div>\n//       <div className={toggle === 2 ? \"w-screen\" : \"hidden\"}>\n//         <WatchlistPage />\n//       </div>\n//       <div className={toggle === 3 ? \"grid grid-cols-2\" : \"hidden\"}>\n//         <div className=\"h-screen border-r-2 flex flex-col items-center\">\n//           <div className=\"m-6\">requests</div>\n//           <div className=\"m-6\"><FriendsBar userId={userId} /></div>\n//           <FriendRequestsDropdown userId={userId} />\n//         </div>\n//         <div className=\"flex flex-col items-center\">\n//           <h2 className=\"p-2 my-4\">friends</h2>\n//           {friends.map(friend => (\n//             <div className=\"border-b flex justify-between w-3/4\" key={friend.id}>\n//               {friend.username}\n//               <button className=\"hover:underline\" onClick={() => deleteFriend(friend.id)}>remove</button>\n//             </div>\n//           ))}\n//         </div>\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\n"],"mappings":"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AAM,GAAG,CAAC,GAAG,kBAAkB,GAAG,QAAS;MAAAR,QAAA,EAChEf,OAAO,CAAC4B,GAAG,CAACC,MAAM,iBACjB3C,OAAA;QAAqBkC,SAAS,EAAC,qCAAqC;QAAAL,QAAA,EACjEc,MAAM,CAACC,cAAc,CAACT;MAAQ,GADvBQ,MAAM,CAACvB,EAAE;QAAAU,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAGd,CACN;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAAC/B,EAAA,CAhGID,WAAW;EAAA,QACET,WAAW,EACAE,OAAO;AAAA;AAAAmD,EAAA,GAF/B5C,WAAW;AAkGjB,eAAeA,WAAW;;AAG1B;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGA;;AAIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAAA,IAAA4C,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}