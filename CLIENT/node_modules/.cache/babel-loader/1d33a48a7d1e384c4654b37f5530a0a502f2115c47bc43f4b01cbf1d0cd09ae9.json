{"ast":null,"code":"var _jsxFileName = \"/Users/midhu1/Projects/mediaconsumption/CLIENT/src/pages/ProfilePage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport client from '../utils/supabaseClient'; // Adjust this path as necessary\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProfilePage = () => {\n  _s();\n  const navigate = useNavigate();\n  const [username, setUsername] = useState('Guest');\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const fetchProfile = async () => {\n      const user = supabase.auth.user(); // Correct usage to fetch the currently authenticated user\n\n      if (!user) {\n        console.error(\"No user found. Redirecting to login.\");\n        navigate('/login');\n        return;\n      }\n      const {\n        data,\n        error\n      } = await supabase.from('profiles').select('username').eq('user_id', user.id).single();\n      if (error) {\n        console.error('Error fetching profile:', error.message);\n        navigate('/');\n        return;\n      }\n      setUsername(data === null || data === void 0 ? void 0 : data.username);\n      setLoading(false);\n    };\n    fetchProfile();\n  }, [navigate]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-screen h-screen flex flex-col items-center pt-10\",\n    children: /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-2xl mb-16 text-center\",\n      children: [\"Clerk Profile: \", username]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n};\n_s(ProfilePage, \"EXSn42MfVR08LrwiBdTA1PJlE1w=\", false, function () {\n  return [useNavigate];\n});\n_c = ProfilePage;\nexport default ProfilePage;\n\n// // ProfilePage.js\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useSupabaseClient } from '../utils/auth'; // Import the hook\n// import WatchlistPage from './WatchlistPage';\n// import FriendsBar from '../components/common/FriendsBar';\n// import FriendRequestsDropdown from '../components/common/FriendRequests';\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const supabase = useSupabaseClient(); // Use the hook\n//   const [username, setUsername] = useState('Guest');\n//   const [loading, setLoading] = useState(true);\n//   const [userId, setUserId] = useState(null);\n//   const [toggle, setToggle] = useState(1);\n//   const [friends, setFriends] = useState([]);\n\n//   useEffect(() => {\n//     const fetchUserData = async () => {\n//       const { data: { user }, error: userError } = await supabase.auth.getUser();\n\n//       if (userError || !user) {\n//         console.log(\"Cooked.\");\n//         navigate('/');\n//         return;\n//       }\n\n//       setUserId(user.id);\n\n//       const { data: profile, error: profileError } = await supabase\n//         .from('profiles')\n//         .select('username')\n//         .eq('user_id', user.id)\n//         .single();\n\n//       if (profileError) {\n//         console.error('Error fetching user data:', profileError.message);\n//         navigate('/');\n//       } else if (profile) {\n//         setUsername(profile.username);\n//       }\n\n//       setLoading(false);\n//     };\n\n//     const fetchFriends = async () => {\n//       if (!userId) return; // Only fetch if userId is available\n//       const { data, error } = await supabase\n//         .from('friends')\n//         .select(`\n//           friend_id,\n//           friend_profile:friend_id (username) // Adjusted for correct relationship fetching\n//         `)\n//         .eq('user_id', userId)\n//         .eq('status', 'accepted');\n\n//       if (error) {\n//         console.error('Error fetching friends:', error.message);\n//       } else {\n//         console.log('Fetched friends data:', data); // Logs successful data fetch.\n\n//         setFriends(data.map(friend => ({\n//           id: friend.friend_id,\n//           username: friend.friend_profile.username  // Assuming the returned data structure from the query\n//         })));\n//       }\n//     };\n\n//     fetchUserData();\n\n//     if (userId) fetchFriends(); // Fetch friends if userId is available\n//   }, [navigate, supabase, userId]);\n\n//   if (loading) {\n//     return <div>Loading...</div>;\n//   }\n\n//   const updateToggle = (id) => {\n//     setToggle(id);\n//   };\n\n//   const deleteFriend = async (deletedId) => {\n//     if (window.confirm(`Are you sure you want to delete this friend?`)) {\n//       const { error } = await supabase\n//         .from('friends')\n//         .delete()\n//         .or(`and(user_id.eq.${userId},friend_id.eq.${deletedId}),and(user_id.eq.${deletedId},friend_id.eq.${userId})`);\n\n//       if (error) {\n//         console.error('Error deleting friend:', error.message);\n//       } else {\n//         setFriends(currentFriends => currentFriends.filter(friend => friend.id !== deletedId));\n//       }\n//     }\n//   };\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <div className=\"flex justify-end w-5/6\">\n//         <div className=\"tab-bar grid grid-col-1\">\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(1)}>Profile</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(2)}>Lists</span>\n//           <span className=\"pl-4 py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(3)}>Friends</span>\n//         </div>\n//       </div>\n//       <div className={toggle === 1 ? \"w-5/6\" : \"hidden\"}>\n//         <h1 className=\"text-2xl mb-16 text-left\">profpic {username}</h1>\n//         <div className=\"mt-16 grid grid-cols-4\">\n//           <div className=\"border-2 m-4 rounded-full py-8 px-4 grid grid-cols-1\">\n//             <span>lists: </span>\n//             <span>{friends.length}</span>\n//           </div>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">to consume: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consuming: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consumed: </span>\n//         </div>\n//       </div>\n//       <div className={toggle === 2 ? \"w-screen\" : \"hidden\"}>\n//         <WatchlistPage />\n//       </div>\n//       <div className={toggle === 3 ? \"grid grid-cols-2\" : \"hidden\"}>\n//         <div className=\"h-screen border-r-2 flex flex-col items-center\">\n//           <div className=\"m-6\">requests</div>\n//           <div className=\"m-6\"><FriendsBar userId={userId} /></div>\n//           <FriendRequestsDropdown userId={userId} />\n//         </div>\n//         <div className=\"flex flex-col items-center\">\n//           <h2 className=\"p-2 my-4\">friends</h2>\n//           {friends.map(friend => (\n//             <div className=\"border-b flex justify-between w-3/4\" key={friend.id}>\n//               {friend.username}\n//               <button className=\"hover:underline\" onClick={() => deleteFriend(friend.id)}>remove</button>\n//             </div>\n//           ))}\n//         </div>\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","client","jsxDEV","_jsxDEV","ProfilePage","_s","navigate","username","setUsername","loading","setLoading","fetchProfile","user","supabase","auth","console","error","data","from","select","eq","id","single","message","children","fileName","_jsxFileName","lineNumber","columnNumber","className","_c","$RefreshReg$"],"sources":["/Users/midhu1/Projects/mediaconsumption/CLIENT/src/pages/ProfilePage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport client from '../utils/supabaseClient';  // Adjust this path as necessary\n\nconst ProfilePage = () => {\n  const navigate = useNavigate();\n  const [username, setUsername] = useState('Guest');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchProfile = async () => {\n      const user = supabase.auth.user();  // Correct usage to fetch the currently authenticated user\n\n      if (!user) {\n        console.error(\"No user found. Redirecting to login.\");\n        navigate('/login');\n        return;\n      }\n\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('username')\n        .eq('user_id', user.id)\n        .single();\n\n      if (error) {\n        console.error('Error fetching profile:', error.message);\n        navigate('/');\n        return;\n      }\n\n      setUsername(data?.username);\n      setLoading(false);\n    };\n\n    fetchProfile();\n  }, [navigate]);\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n      <h1 className=\"text-2xl mb-16 text-center\">Clerk Profile: {username}</h1>\n      {/* More JSX for user profile, friends list, etc., can be added here */}\n    </div>\n  );\n};\n\nexport default ProfilePage;\n\n\n\n// // ProfilePage.js\n// import React, { useEffect, useState } from 'react';\n// import { useNavigate } from 'react-router-dom';\n// import { useSupabaseClient } from '../utils/auth'; // Import the hook\n// import WatchlistPage from './WatchlistPage';\n// import FriendsBar from '../components/common/FriendsBar';\n// import FriendRequestsDropdown from '../components/common/FriendRequests';\n\n// const ProfilePage = () => {\n//   const navigate = useNavigate();\n//   const supabase = useSupabaseClient(); // Use the hook\n//   const [username, setUsername] = useState('Guest');\n//   const [loading, setLoading] = useState(true);\n//   const [userId, setUserId] = useState(null);\n//   const [toggle, setToggle] = useState(1);\n//   const [friends, setFriends] = useState([]);\n\n//   useEffect(() => {\n//     const fetchUserData = async () => {\n//       const { data: { user }, error: userError } = await supabase.auth.getUser();\n\n//       if (userError || !user) {\n//         console.log(\"Cooked.\");\n//         navigate('/');\n//         return;\n//       }\n\n//       setUserId(user.id);\n\n//       const { data: profile, error: profileError } = await supabase\n//         .from('profiles')\n//         .select('username')\n//         .eq('user_id', user.id)\n//         .single();\n\n//       if (profileError) {\n//         console.error('Error fetching user data:', profileError.message);\n//         navigate('/');\n//       } else if (profile) {\n//         setUsername(profile.username);\n//       }\n\n//       setLoading(false);\n//     };\n\n//     const fetchFriends = async () => {\n//       if (!userId) return; // Only fetch if userId is available\n//       const { data, error } = await supabase\n//         .from('friends')\n//         .select(`\n//           friend_id,\n//           friend_profile:friend_id (username) // Adjusted for correct relationship fetching\n//         `)\n//         .eq('user_id', userId)\n//         .eq('status', 'accepted');\n\n//       if (error) {\n//         console.error('Error fetching friends:', error.message);\n//       } else {\n//         console.log('Fetched friends data:', data); // Logs successful data fetch.\n\n//         setFriends(data.map(friend => ({\n//           id: friend.friend_id,\n//           username: friend.friend_profile.username  // Assuming the returned data structure from the query\n//         })));\n//       }\n//     };\n\n//     fetchUserData();\n\n//     if (userId) fetchFriends(); // Fetch friends if userId is available\n//   }, [navigate, supabase, userId]);\n\n//   if (loading) {\n//     return <div>Loading...</div>;\n//   }\n\n//   const updateToggle = (id) => {\n//     setToggle(id);\n//   };\n\n//   const deleteFriend = async (deletedId) => {\n//     if (window.confirm(`Are you sure you want to delete this friend?`)) {\n//       const { error } = await supabase\n//         .from('friends')\n//         .delete()\n//         .or(`and(user_id.eq.${userId},friend_id.eq.${deletedId}),and(user_id.eq.${deletedId},friend_id.eq.${userId})`);\n\n//       if (error) {\n//         console.error('Error deleting friend:', error.message);\n//       } else {\n//         setFriends(currentFriends => currentFriends.filter(friend => friend.id !== deletedId));\n//       }\n//     }\n//   };\n\n//   return (\n//     <div className=\"w-screen h-screen flex flex-col items-center pt-10\">\n//       <div className=\"flex justify-end w-5/6\">\n//         <div className=\"tab-bar grid grid-col-1\">\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(1)}>Profile</span>\n//           <span className=\"py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(2)}>Lists</span>\n//           <span className=\"pl-4 py-1 cursor-pointer text-right border-b border-black\" onClick={() => updateToggle(3)}>Friends</span>\n//         </div>\n//       </div>\n//       <div className={toggle === 1 ? \"w-5/6\" : \"hidden\"}>\n//         <h1 className=\"text-2xl mb-16 text-left\">profpic {username}</h1>\n//         <div className=\"mt-16 grid grid-cols-4\">\n//           <div className=\"border-2 m-4 rounded-full py-8 px-4 grid grid-cols-1\">\n//             <span>lists: </span>\n//             <span>{friends.length}</span>\n//           </div>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">to consume: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consuming: </span>\n//           <span className=\"border-2 m-4 rounded-full py-8 px-4\">consumed: </span>\n//         </div>\n//       </div>\n//       <div className={toggle === 2 ? \"w-screen\" : \"hidden\"}>\n//         <WatchlistPage />\n//       </div>\n//       <div className={toggle === 3 ? \"grid grid-cols-2\" : \"hidden\"}>\n//         <div className=\"h-screen border-r-2 flex flex-col items-center\">\n//           <div className=\"m-6\">requests</div>\n//           <div className=\"m-6\"><FriendsBar userId={userId} /></div>\n//           <FriendRequestsDropdown userId={userId} />\n//         </div>\n//         <div className=\"flex flex-col items-center\">\n//           <h2 className=\"p-2 my-4\">friends</h2>\n//           {friends.map(friend => (\n//             <div className=\"border-b flex justify-between w-3/4\" key={friend.id}>\n//               {friend.username}\n//               <button className=\"hover:underline\" onClick={() => deleteFriend(friend.id)}>remove</button>\n//             </div>\n//           ))}\n//         </div>\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default ProfilePage;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,MAAM,MAAM,yBAAyB,CAAC,CAAE;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE/C,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACxB,MAAMC,QAAQ,GAAGN,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACO,QAAQ,EAAEC,WAAW,CAAC,GAAGT,QAAQ,CAAC,OAAO,CAAC;EACjD,MAAM,CAACU,OAAO,EAAEC,UAAU,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EAE5CD,SAAS,CAAC,MAAM;IACd,MAAMa,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,MAAMC,IAAI,GAAGC,QAAQ,CAACC,IAAI,CAACF,IAAI,CAAC,CAAC,CAAC,CAAE;;MAEpC,IAAI,CAACA,IAAI,EAAE;QACTG,OAAO,CAACC,KAAK,CAAC,sCAAsC,CAAC;QACrDV,QAAQ,CAAC,QAAQ,CAAC;QAClB;MACF;MAEA,MAAM;QAAEW,IAAI;QAAED;MAAM,CAAC,GAAG,MAAMH,QAAQ,CACnCK,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAAC,UAAU,CAAC,CAClBC,EAAE,CAAC,SAAS,EAAER,IAAI,CAACS,EAAE,CAAC,CACtBC,MAAM,CAAC,CAAC;MAEX,IAAIN,KAAK,EAAE;QACTD,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAACO,OAAO,CAAC;QACvDjB,QAAQ,CAAC,GAAG,CAAC;QACb;MACF;MAEAE,WAAW,CAACS,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEV,QAAQ,CAAC;MAC3BG,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC;IAEDC,YAAY,CAAC,CAAC;EAChB,CAAC,EAAE,CAACL,QAAQ,CAAC,CAAC;EAEd,IAAIG,OAAO,EAAE;IACX,oBAAON,OAAA;MAAAqB,QAAA,EAAK;IAAU;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAC9B;EAEA,oBACEzB,OAAA;IAAK0B,SAAS,EAAC,oDAAoD;IAAAL,QAAA,eACjErB,OAAA;MAAI0B,SAAS,EAAC,4BAA4B;MAAAL,QAAA,GAAC,iBAAe,EAACjB,QAAQ;IAAA;MAAAkB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAEtE,CAAC;AAEV,CAAC;AAACvB,EAAA,CA5CID,WAAW;EAAA,QACEJ,WAAW;AAAA;AAAA8B,EAAA,GADxB1B,WAAW;AA8CjB,eAAeA,WAAW;;AAI1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAAA,IAAA0B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}